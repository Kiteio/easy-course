# 广东财经大学自动选课

## 免责声明
- 本项目仅供学习参考，因个人原因使用本项目造成的一切损失与项目无关。
- 本项目完全免费，请勿以任何方式使用本项目向他人收取费用。
- 选课会轮询服务器（间隔 1 秒），请勿长时间挂，特别是必修课这类不扩容、少退选的课。

## 用法
1. 下载 [Python](https://www.python.org/)
2. 将本项目 [main.py](python/main.py) 保存到本地（可以直接复制，也可以下载）
3. 在命令行下载 Python 库，要一行一行输入（有[requirements.txt](python/requirements.txt)，如果熟悉也可以换用这个）。
    ```
    pip install requests
    pip install bs4
    pip install ddddocr
    ```
   > 注意：运行时如果报了以下错误（只给出了开头）：
   > ```
   > A module that was compiled using NumPy 1.x cannot be run in NumPy 2.0.0 as it may crash. 
   > To support both 1.x and 2.x version of NumPy, modules must be compiled with NumPy 2.0.
   > Some module may need to rebuild instead e.g. with 'pybind11>2.12'.
   > ```
   > 需要将`numpy 2.0`删了：
   > ```
   > pip uninstall numpy
   > ```
   > 下载`1.26.2`版本（你可以在下载`ddddocr`之前运行该命令，这样它就不会再下`numpy 2.0`）：
   > ```
   > pip install numpy==1.26.2
   > ```
4. 在代码最前面配置参数(11 - 26行，请参考[参数说明](#参数说明))。
   ```python
   # 必填参数
   USERNAME = ""  # 学号
   PASSWORD = ""  # 门户密码
   SORT = "必修课"  # 课程分类，必修课（学科基础、专业必修课）、选修课（专业选修课）、通识课、专业内计划课、跨年级、跨专业
   PAGE = 1  # 页码，从 1 开始，超出页码会异常，可以参考网站搜索后出的页码
   INDEX = -1  # 下标，请根据运行结果给出课程开头的数字
   
   # 可选参数（仅限非必修、选修课）
   NAME = ""  # 课程名
   TEACHER = ""  # 教师名称
   DAY_OF_WEEK = ""  # 星期几，1 ~ 7，写数字就行了
   SECTION = ""  # 节次，如 “1-2”，如果不为空则 DAY_OF_WEEK 也必须给出，不然结果是空的
   ```
   示例配置（参考第 5 步结果第一个）
   ```python
   # 必填参数
   USERNAME = "2125..."
   PASSWORD = "***"
   SORT = "通识课"
   PAGE = 1  # 在选课系统网站的第一页
   INDEX = 0  # 我要的是下标为 [0] 的中国自然和人文景观鉴赏
   
   # 可选参数
   NAME = "中国自然和人文景观鉴赏"
   TEACHER = "徐茜"
   DAY_OF_WEEK = "3"  # 周三
   SECTION = "7-8"  # 第 7-8 节，如果这里写了内容，DAY_OF_WEEK 也必须写出对应周几
   ```
5. 运行代码
   ```
   // 参考
   ...
   结果:
   [0] 课程号: 20150362, 课程名称: 中国自然和人文景观鉴赏 , 学分: 3, 教师: 徐茜,, 上课时间: 1-16周 星期三 7-8节, 上课地点: 博学楼513, 课堂人数: 55, 选课人数: 9, id: 202420251004837
   [1] 课程号: 20150362, 课程名称: 中国自然和人文景观鉴赏 , 学分: 3, 教师: 徐茜,, 上课时间: 1-16周 星期三 5-6节, 上课地点: 博学楼513, 课堂人数: 55, 选课人数: 10, id: 202420251004835
   [2] 课程号: 20150362, 课程名称: 中国自然和人文景观鉴赏 , 学分: 3, 教师: 徐茜,, 上课时间: 1-16周 星期三 3-4节, 上课地点: 博学楼513, 课堂人数: 55, 选课人数: 0, id: 202420251004806
   [3] 课程号: 21050042, 课程名称: 生活中的金融学 , 学分: 3, 教师: 潘成夫,, 上课时间: 1-16周 星期四 5-6节, 上课地点: 励学楼(SJ1)510, 课堂人数: 55, 选课人数: 6, id: 202420251004540
   ...
   ```

## 参数说明
| 参数名               | 说明                                                                                                                                                |
|-------------------|---------------------------------------------------------------------------------------------------------------------------------------------------|
| `USERNAME`        | 用户名                                                                                                                                               |
| `PASSWORD`        | 密码                                                                                                                                                |
| `SORT`            | 课程分类，有效值：`必修课`、`选修课`、`专业内计划课`、`跨年级`、`跨专业`                                                                                                         |
| `PAGE`            | 默认值为`1`。因为课程数据过多，每一页最大只显示 14 个课程，需要通过指定页码来换页，从`1`开始                                                                                               |
| `INDEX`           | 默认值为`-1`。你所要课程项的下标，值为`-1`则不选课。不知道下标请先设置为`-1`，运行一遍，看打印出的“结果：”下边课程项的开头方括号`[]`括起来的值                                                                  |
| `NAME`            | 课程名。对于`必修课`、`选修课`该值**无效**                                                                                                                         |
| `TEACHER`         | 教师名。对于`必修课`、`选修课`该值**无效**                                                                                                                         |
| `DAY_OF_WEEK`     | 星期几的课，有效值：`1`~`7`，例如`1`代表该课程是在星期一的课程。对于`必修课`、`选修课`该值**无效**                                                                                        |
| `SECTION`         | 节次，有效值：`1-2`、`3-4`...`11-12`，如果有多个节次，填一个就行，如果该值**不**为空，则`DAY_OF_WEEK`也必须**不**为空。对于`必修课`、`选修课`该值**无效**                                             |
| `ENTER_MAX_RETRY` | 默认值为`20`。进入选课系统是需要点击链接的，而选课开始前该链接并未出现，如果没有链接会尝试刷新，该参数为最大刷新次数。<br/>超出最大次数将抛出异常。                                                                    |
| `ENTER_INTERVAL`  | 默认值为`2`。上述`ENTER_MAX_RETRY`每一次刷新的时间间隔，单位为秒。<br/>两者相乘的时间所得秒数是提前运行的最大时间限度（例如 20 * 2s，则必须在选课前 40s 到选课开始的这段时间内运行，如果是前 41s 运行，则会在选课开始前一秒抛出异常，无法进入选课系统） |
| `INTERVAL`        | 默认值为`1`。发起选课请求的时间间隔，单位秒。因为课程会出现满员的情况，设置了该轮询功能用于蹲别人退课，这也是该项目的初衷。                                                                                   |

## 联系方式
如果有任何问题，请联系微信。
```
17875765201
```